--
-- create or replace function limit_job_status() RETURNS trigger AS
-- $$
-- declare
--     status_count integer := 0;
--     must_check   boolean := false;
-- begin
--     if TG_OP = 'INSERT' THEN
--         must_check := true;
--     end if;
--     if TG_OP = 'UPDATE' then
--         if (NEW.status != OLD.status) then
--             must_check := true;
--         end if;
--     end if;
--     if must_check then
--         lock table collect_sids_job in exclusive mode;
--         select into status_count count(*)
--         from collect_sids_job
--         where status == 'not started';
--         if status_count > 1 then
--             raise exception 'Cannot insert more than 1 jobs in the not started status';
--         end if;
--         select into status_count count(*)
--         from collect_sids_job
--         where status == 'in progress';
--         if status_count > 1 then
--             raise exception 'Cannot insert more than 1 jobs in the in progress status';
--         end if;
--     end if;
--     return NEW;
-- end
-- $$ LANGUAGE plpgsql;